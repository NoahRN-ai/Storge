# Storge Family Chat

A simple real-time chat application designed for families, built with modern web technologies.

## Core Technologies

*   **Frontend:** React, Vite
*   **Backend:** Supabase
    *   Database: PostgreSQL
    *   Authentication
    *   Realtime Subscriptions
    *   Edge Functions (Deno runtime)

## Prerequisites

Before you begin, ensure you have the following installed:

*   Node.js (v18 or newer recommended)
*   npm (usually comes with Node.js)
*   Supabase CLI (v1.100.0 or newer recommended) - [Installation Guide](https://supabase.com/docs/guides/cli/getting-started)

## Local Development Setup

Follow these steps to get the Storge application running locally:

1.  **Clone the Repository:**
    ```bash
    git clone https://github.com/your-username/storge.git # Replace with your repo URL
    cd storge
    ```

2.  **Set up Supabase Locally:**
    *   Initialize Supabase (if this is the first time setting up the project in this directory, otherwise skip):
        ```bash
        supabase init
        ```
    *   Start Supabase services (database, auth, storage, etc.):
        ```bash
        supabase start
        ```
        After this command completes, Supabase will output API URL, anon key, and other useful information. You'll need these for the frontend configuration.

3.  **Configure Frontend Environment:**
    *   Navigate to the frontend directory:
        ```bash
        cd storge
        ```
        (If you're not already in the `storge` subdirectory that contains `package.json`)
    *   Install frontend dependencies:
        ```bash
        npm install
        ```
    *   Create a `.env` file for frontend environment variables by copying the example:
        ```bash
        cp .env.example .env
        ```
    *   Open `storge/.env` and fill in the Supabase details:
        *   `VITE_SUPABASE_URL`: Get this from the output of `supabase status` (usually `API URL`).
        *   `VITE_SUPABASE_ANON_KEY`: Get this from the output of `supabase status` (usually `anon key`).

4.  **Configure Backend (Edge Function) Environment:**
    *   Supabase Edge Functions running locally via the CLI can pick up environment variables from `supabase/.env.local`.
    *   Create or open the file `supabase/.env.local` (create the `supabase` directory if it doesn't exist at the root of your Supabase project initialized by `supabase init`).
    *   Add the PIN for the login function:
        ```
        APP_PIN=your_chosen_4_digit_pin
        ```
        Replace `your_chosen_4_digit_pin` with the actual PIN you want to use for local login (e.g., `2215`).

5.  **Run Frontend Development Server:**
    *   While still in the `storge` (frontend) directory:
        ```bash
        npm run dev
        ```
    *   Open your browser and navigate to the URL provided by Vite (usually `http://localhost:5173`).

6.  **Deploy Supabase Edge Function(s):**
    *   From the root directory of your Supabase project (where `supabase` directory is located):
        ```bash
        supabase functions deploy storge-login --no-verify-jwt
        ```
        The `--no-verify-jwt` flag is used for simplicity in this project as the function handles its own basic auth. For production apps with proper Supabase Auth, JWT verification would typically be enabled.

    You should now be able to use the login page and access the chat application.

## Project Structure Overview

*   `README.md`: This file.
*   `storge/`: Contains the frontend React/Vite application.
    *   `public/`: Static assets for the frontend.
    *   `src/`: Frontend source code.
        *   `assets/`: Image assets.
        *   `components/`: React components (`LoginPage.jsx`, `ChatPage.jsx`).
        *   `App.jsx`: Main application component.
        *   `main.jsx`: Entry point for the React application.
        *   `supabaseClient.js`: Initializes the Supabase JavaScript client.
        *   `index.css`: Global styles.
    *   `.env.example`: Example environment variables for the frontend.
    *   `package.json`: Frontend dependencies and scripts.
    *   `vite.config.js`: Vite configuration.
*   `supabase/`: Contains backend Supabase project configuration and functions.
    *   `functions/`: Directory for Edge Functions.
        *   `storge-login/`: The login Edge Function.
            *   `index.ts`: TypeScript code for the login function.
    *   `config.toml`: Supabase project configuration for local development.
    *   `.env.local`: (Not committed) Local environment variables for Supabase functions.
    *   (Other files/folders generated by `supabase init` like `migrations/`, `seed.sql` etc.)

## Further Development

*   **Implement proper user authentication:** Move beyond the hardcoded user list and PIN to use Supabase Auth.
*   **Database for users:** Store user profiles in a Supabase database table.
*   **Add more features:** Typing indicators, online status, user profiles, etc.
*   **Testing:** Implement unit, integration, and end-to-end tests.
*   **Styling:** Enhance the UI/UX.
```
